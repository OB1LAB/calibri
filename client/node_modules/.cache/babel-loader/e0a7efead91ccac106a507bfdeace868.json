{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import classes from\"./History.module.css\";import Selector from\"../Selectors/Selector\";import Modal from\"../modal/Modal\";import MarketService from\"../../services/MarketService\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var options=[{value:\"На рассмотрении\",label:\"На рассмотрении\"},{value:\"Выдано\",label:\"Выдано\"},{value:\"Отказано\",label:\"Отказано\"}];export default function HistoryBuyTable(_ref){var data=_ref.data,user=_ref.user,setData=_ref.setData;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),rowId=_useState2[0],setRowId=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modal=_useState6[0],setModal=_useState6[1];var editStatus=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return MarketService.setTypeHistory(rowId,state);case 2:response=_context.sent;response&&setData(response.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function editStatus(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u043F\\u043E\\u043A\\u0443\\u043F\\u043E\\u043A\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u043F\\u043E\\u043A\\u0443\\u043F\\u043E\\u043A \\u043D\\u0435 \\u043E\\u0447\\u0438\\u0449\\u0430\\u0435\\u0442\\u0441\\u044F\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"\".concat(classes.generalTable,\" \").concat(classes.historyBuy),id:\"history\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"# \\u043F/\\u043F\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u041D\\u0438\\u043A\\u043D\\u0435\\u0439\\u043C \\u043C\\u043E\\u0434\\u0435\\u0440\\u0430\\u0442\\u043E\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u0414\\u0430\\u0442\\u0430 \\u043F\\u043E\\u043A\\u0443\\u043F\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0443\\u0441\\u043B\\u0443\\u0433\\u0438\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u0426\\u0435\\u043D\\u0430\"}),user[\"max_role\"][\"lvl\"]>4&&/*#__PURE__*/_jsx(\"td\",{children:\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.sort(function(a,b){return a.id-b.id;}).map(function(value,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:value.user}),/*#__PURE__*/_jsx(\"td\",{children:value.date}),/*#__PURE__*/_jsx(\"td\",{dangerouslySetInnerHTML:{__html:value.item}}),/*#__PURE__*/_jsx(\"td\",{children:value.amount}),/*#__PURE__*/_jsx(\"td\",{children:value.price}),user[\"max_role\"][\"lvl\"]>4&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:classes.buySelectState,children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){setRowId(value.id);setState(value.state);setModal(true);},children:value.state})})})]},value.id);})})]}),/*#__PURE__*/_jsx(Modal,{visible:modal,setVisible:setModal,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.historyBuyModal,children:[/*#__PURE__*/_jsx(Selector,{options:options,value:{value:state,label:state},onChange:function onChange(_ref3){var value=_ref3.value;return setState(value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){editStatus();setModal(false);},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})})]});}","map":{"version":3,"names":["useState","classes","Selector","Modal","MarketService","options","value","label","HistoryBuyTable","data","user","setData","rowId","setRowId","state","setState","modal","setModal","editStatus","setTypeHistory","response","generalTable","historyBuy","sort","a","b","id","map","index","date","__html","item","amount","price","buySelectState","historyBuyModal"],"sources":["C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/src/components/tables/HistoryBuy.jsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport classes from \"./History.module.css\";\r\nimport Selector from \"../Selectors/Selector\";\r\nimport Modal from \"../modal/Modal\";\r\nimport MarketService from \"../../services/MarketService\";\r\n\r\nconst options = [\r\n  { value: \"На рассмотрении\", label: \"На рассмотрении\" },\r\n  { value: \"Выдано\", label: \"Выдано\" },\r\n  { value: \"Отказано\", label: \"Отказано\" },\r\n];\r\n\r\nexport default function HistoryBuyTable({ data, user, setData }) {\r\n  const [rowId, setRowId] = useState(0);\r\n  const [state, setState] = useState(\"\");\r\n  const [modal, setModal] = useState(false);\r\n  const editStatus = async () => {\r\n    const response = await MarketService.setTypeHistory(rowId, state);\r\n    response && setData(response.data);\r\n  };\r\n  return (\r\n    <div>\r\n      <h2>История покупок</h2>\r\n      <p>История покупок не очищается</p>\r\n      <table\r\n        className={`${classes.generalTable} ${classes.historyBuy}`}\r\n        id=\"history\"\r\n      >\r\n        <thead>\r\n          <tr>\r\n            <td># п/п</td>\r\n            <td>Никнейм модератора</td>\r\n            <td>Дата покупки</td>\r\n            <td>Наименование услуги</td>\r\n            <td>Количество</td>\r\n            <td>Цена</td>\r\n            {user[\"max_role\"][\"lvl\"] > 4 && <td>Действие</td>}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {data\r\n            .sort((a, b) => a.id - b.id)\r\n            .map((value, index) => {\r\n              return (\r\n                <tr key={value.id}>\r\n                  <td>{index + 1}</td>\r\n                  <td>{value.user}</td>\r\n                  <td>{value.date}</td>\r\n                  <td dangerouslySetInnerHTML={{ __html: value.item }}></td>\r\n                  <td>{value.amount}</td>\r\n                  <td>{value.price}</td>\r\n                  {user[\"max_role\"][\"lvl\"] > 4 && (\r\n                    <td>\r\n                      <div className={classes.buySelectState}>\r\n                        <button\r\n                          onClick={() => {\r\n                            setRowId(value.id);\r\n                            setState(value.state);\r\n                            setModal(true);\r\n                          }}\r\n                        >\r\n                          {value.state}\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  )}\r\n                </tr>\r\n              );\r\n            })}\r\n        </tbody>\r\n      </table>\r\n      <Modal visible={modal} setVisible={setModal}>\r\n        <div className={classes.historyBuyModal}>\r\n          <Selector\r\n            options={options}\r\n            value={{ value: state, label: state }}\r\n            onChange={({ value }) => setState(value)}\r\n          />\r\n          <button\r\n            onClick={() => {\r\n              editStatus();\r\n              setModal(false);\r\n            }}\r\n          >\r\n            Сохранить\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}