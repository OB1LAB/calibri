{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import HistoryBuyTable from\"../components/tables/HistoryBuy\";import HistoryVacationTable from\"../components/tables/HistoryVacation\";import HistoryViolationsTable from\"../components/tables/HistoryViolations\";import SelectServer from\"../components/Selectors/SelectServer\";import HistoryService from\"../services/HistoryService\";import Loader from\"../components/Loader/Loader\";import{Context}from\"..\";import\"../styles/History.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function HistoryPage(){var _useContext=useContext(Context),store=_useContext.store;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(\"dt\"),_useState4=_slicedToArray(_useState3,2),selectedServer=_useState4[0],setselectedServer=_useState4[1];useEffect(function(){var tables=document.querySelectorAll(\"[id=history]\");tables.forEach(function(table){var scrollHeight=table.scrollHeight;var height=table.clientHeight;var maxScrollTop=scrollHeight-height;table.scrollTop=maxScrollTop>0?maxScrollTop:0;});},[selectedServer]);useEffect(function(){var setHistory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,tables;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return HistoryService.fetchHistory();case 2:response=_context.sent;response&&setData(response.data);tables=document.querySelectorAll(\"[id=history]\");tables.forEach(function(table){var scrollHeight=table.scrollHeight;var height=table.clientHeight;var maxScrollTop=scrollHeight-height;table.scrollTop=maxScrollTop>0?maxScrollTop:0;});case 6:case\"end\":return _context.stop();}}},_callee);}));return function setHistory(){return _ref.apply(this,arguments);};}();setHistory();document.title=\"История & Выдача\";},[]);if(Object.keys(data).length===0){return/*#__PURE__*/_jsx(Loader,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"tables\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"selectServer\",children:/*#__PURE__*/_jsx(SelectServer,{onChange:function onChange(_ref2){var value=_ref2.value;setselectedServer(value);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"up\",children:[/*#__PURE__*/_jsx(HistoryVacationTable,{user:store.user,data:data[selectedServer][\"vacation\"],selectedServer:selectedServer,setData:setData}),/*#__PURE__*/_jsx(HistoryViolationsTable,{data:data[selectedServer][\"violation\"],user:store.user,selectedServer:selectedServer,setData:setData})]}),/*#__PURE__*/_jsx(\"div\",{className:\"down\",children:/*#__PURE__*/_jsx(HistoryBuyTable,{setData:setData,data:data[selectedServer][\"buy\"],user:store.user})})]});}","map":{"version":3,"names":["React","useState","useEffect","useContext","HistoryBuyTable","HistoryVacationTable","HistoryViolationsTable","SelectServer","HistoryService","Loader","Context","HistoryPage","store","data","setData","selectedServer","setselectedServer","tables","document","querySelectorAll","forEach","table","scrollHeight","height","clientHeight","maxScrollTop","scrollTop","setHistory","fetchHistory","response","title","Object","keys","length","value","user"],"sources":["C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/src/pages/HistoryPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport HistoryBuyTable from \"../components/tables/HistoryBuy\";\r\nimport HistoryVacationTable from \"../components/tables/HistoryVacation\";\r\nimport HistoryViolationsTable from \"../components/tables/HistoryViolations\";\r\nimport SelectServer from \"../components/Selectors/SelectServer\";\r\nimport HistoryService from \"../services/HistoryService\";\r\nimport Loader from \"../components/Loader/Loader\";\r\nimport { Context } from \"..\";\r\nimport \"../styles/History.css\";\r\n\r\nexport default function HistoryPage() {\r\n  const { store } = useContext(Context);\r\n  const [data, setData] = useState({});\r\n  const [selectedServer, setselectedServer] = useState(\"dt\");\r\n\r\n  useEffect(() => {\r\n    const tables = document.querySelectorAll(\"[id=history]\");\r\n    tables.forEach((table) => {\r\n      const scrollHeight = table.scrollHeight;\r\n      const height = table.clientHeight;\r\n      const maxScrollTop = scrollHeight - height;\r\n      table.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\r\n    });\r\n  }, [selectedServer]);\r\n\r\n  useEffect(() => {\r\n    const setHistory = async () => {\r\n      const response = await HistoryService.fetchHistory();\r\n      response && setData(response.data);\r\n      const tables = document.querySelectorAll(\"[id=history]\");\r\n      tables.forEach((table) => {\r\n        const scrollHeight = table.scrollHeight;\r\n        const height = table.clientHeight;\r\n        const maxScrollTop = scrollHeight - height;\r\n        table.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\r\n      });\r\n    };\r\n    setHistory();\r\n    document.title = \"История & Выдача\";\r\n  }, []);\r\n\r\n  if (Object.keys(data).length === 0) {\r\n    return <Loader />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"tables\">\r\n      <div className=\"selectServer\">\r\n        <SelectServer\r\n          onChange={({ value }) => {\r\n            setselectedServer(value);\r\n          }}\r\n        />\r\n      </div>\r\n      <div className=\"up\">\r\n        <HistoryVacationTable\r\n          user={store.user}\r\n          data={data[selectedServer][\"vacation\"]}\r\n          selectedServer={selectedServer}\r\n          setData={setData}\r\n        />\r\n        <HistoryViolationsTable\r\n          data={data[selectedServer][\"violation\"]}\r\n          user={store.user}\r\n          selectedServer={selectedServer}\r\n          setData={setData}\r\n        />\r\n      </div>\r\n      <div className=\"down\">\r\n        <HistoryBuyTable\r\n          setData={setData}\r\n          data={data[selectedServer][\"buy\"]}\r\n          user={store.user}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}