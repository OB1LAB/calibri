{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import classes from\"./Items.module.css\";import Modal from\"../modal/Modal\";import MarketService from\"../../services/MarketService\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var formatter=new Intl.NumberFormat(\"en-US\",{minimumFractionDigits:0,maximumFractionDigits:2});export default function Item(_ref){var itemId=_ref.itemId,name=_ref.name,price=_ref.price,img_url=_ref.img_url,user=_ref.user,selectedServer=_ref.selectedServer;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),amount=_useState2[0],setAmount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),modal=_useState4[0],setModal=_useState4[1];var buyItem=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return MarketService.buyItem(itemId,amount,selectedServer);case 2:case\"end\":return _context.stop();}}},_callee);}));return function buyItem(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:classes.item,children:[/*#__PURE__*/_jsx(\"p\",{className:classes.name,dangerouslySetInnerHTML:{__html:name.split(\"|\")[0]}}),/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:img_url}),name.includes(\"|\")?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setModal(true);},children:price+\" | \"+name.split(\"|\")[1]}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setModal(true);},children:price}),/*#__PURE__*/_jsx(Modal,{visible:modal,setVisible:setModal,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.modalContent,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.modalInfo,children:[/*#__PURE__*/_jsx(\"h3\",{dangerouslySetInnerHTML:{__html:name}}),/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:img_url})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.buy,children:[/*#__PURE__*/_jsx(\"input\",{value:amount,onChange:function onChange(e){if(e.target.value){setAmount(Math.ceil(e.target.value));}else{setAmount(\"\");}},type:\"number\",min:\"0\",placeholder:\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E...\"}),/*#__PURE__*/_jsx(\"button\",{disabled:user.balance-price*amount<0||amount<=0,onClick:function onClick(){setModal(false);buyItem();user.balance-=price*amount;},children:\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u0411\\u0430\\u043B\\u0430\\u043D\\u0441: \",user.balance]}),user.balance-price*amount<-100000000?/*#__PURE__*/_jsx(\"span\",{children:\"\\u041E\\u0441\\u0442\\u0430\\u043D\\u0435\\u0442\\u0441\\u044F: -\\u221E\"}):/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u041E\\u0441\\u0442\\u0430\\u043D\\u0435\\u0442\\u0441\\u044F: \",formatter.format(user.balance-price*amount)]})]})]})})]});}","map":{"version":3,"names":["React","useState","classes","Modal","MarketService","formatter","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","Item","itemId","name","price","img_url","user","selectedServer","amount","setAmount","modal","setModal","buyItem","item","__html","split","includes","modalContent","modalInfo","buy","e","target","value","Math","ceil","balance","format"],"sources":["C:/Users/OB1CHAM/Desktop/OB1LAB/React/calibri/client/src/components/MarketItems/Item.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport classes from \"./Items.module.css\";\r\nimport Modal from \"../modal/Modal\";\r\nimport MarketService from \"../../services/MarketService\";\r\n\r\nconst formatter = new Intl.NumberFormat(\"en-US\", {\r\n  minimumFractionDigits: 0,\r\n  maximumFractionDigits: 2,\r\n});\r\n\r\nexport default function Item({\r\n  itemId,\r\n  name,\r\n  price,\r\n  img_url,\r\n  user,\r\n  selectedServer,\r\n}) {\r\n  const [amount, setAmount] = useState(1);\r\n  const [modal, setModal] = useState(false);\r\n\r\n  const buyItem = async () => {\r\n    await MarketService.buyItem(itemId, amount, selectedServer);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.item}>\r\n      <p\r\n        className={classes.name}\r\n        dangerouslySetInnerHTML={{ __html: name.split(\"|\")[0] }}\r\n      />\r\n      <img alt=\"\" src={img_url}></img>\r\n      {name.includes(\"|\") ? (\r\n        <button onClick={() => setModal(true)}>\r\n          {price + \" | \" + name.split(\"|\")[1]}\r\n        </button>\r\n      ) : (\r\n        <button onClick={() => setModal(true)}>{price}</button>\r\n      )}\r\n      <Modal visible={modal} setVisible={setModal}>\r\n        <div className={classes.modalContent}>\r\n          <div className={classes.modalInfo}>\r\n            <h3 dangerouslySetInnerHTML={{ __html: name }}></h3>\r\n            <img alt=\"\" src={img_url}></img>\r\n          </div>\r\n          <div className={classes.buy}>\r\n            <input\r\n              value={amount}\r\n              onChange={(e) => {\r\n                if (e.target.value) {\r\n                  setAmount(Math.ceil(e.target.value));\r\n                } else {\r\n                  setAmount(\"\");\r\n                }\r\n              }}\r\n              type=\"number\"\r\n              min=\"0\"\r\n              placeholder=\"Количество...\"\r\n            ></input>\r\n            <button\r\n              disabled={user.balance - price * amount < 0 || amount <= 0}\r\n              onClick={() => {\r\n                setModal(false);\r\n                buyItem();\r\n                user.balance -= price * amount;\r\n              }}\r\n            >\r\n              Купить\r\n            </button>\r\n            <span>Баланс: {user.balance}</span>\r\n            {user.balance - price * amount < -100000000 ? (\r\n              <span>Останется: -∞</span>\r\n            ) : (\r\n              <span>\r\n                Останется: {formatter.format(user.balance - price * amount)}\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"8aAAA,MAAOA,MAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,MAAOC,QAAO,KAAM,oBAAoB,CACxC,MAAOC,MAAK,KAAM,gBAAgB,CAClC,MAAOC,cAAa,KAAM,8BAA8B,CAAC,wFAEzD,GAAMC,UAAS,CAAG,GAAIC,KAAI,CAACC,YAAY,CAAC,OAAO,CAAE,CAC/CC,qBAAqB,CAAE,CAAC,CACxBC,qBAAqB,CAAE,CACzB,CAAC,CAAC,CAEF,cAAe,SAASC,KAAI,MAOzB,IANDC,OAAM,MAANA,MAAM,CACNC,IAAI,MAAJA,IAAI,CACJC,KAAK,MAALA,KAAK,CACLC,OAAO,MAAPA,OAAO,CACPC,IAAI,MAAJA,IAAI,CACJC,cAAc,MAAdA,cAAc,CAEd,cAA4Bf,QAAQ,CAAC,CAAC,CAAC,wCAAhCgB,MAAM,eAAEC,SAAS,eACxB,eAA0BjB,QAAQ,CAAC,KAAK,CAAC,yCAAlCkB,KAAK,eAAEC,QAAQ,eAEtB,GAAMC,QAAO,6FAAG,2JACRjB,cAAa,CAACiB,OAAO,CAACV,MAAM,CAAEM,MAAM,CAAED,cAAc,CAAC,uDAC5D,kBAFKK,QAAO,2CAEZ,CAED,mBACE,aAAK,SAAS,CAAEnB,OAAO,CAACoB,IAAK,wBAC3B,UACE,SAAS,CAAEpB,OAAO,CAACU,IAAK,CACxB,uBAAuB,CAAE,CAAEW,MAAM,CAAEX,IAAI,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE,CAAE,EACxD,cACF,YAAK,GAAG,CAAC,EAAE,CAAC,GAAG,CAAEV,OAAQ,EAAO,CAC/BF,IAAI,CAACa,QAAQ,CAAC,GAAG,CAAC,cACjB,eAAQ,OAAO,CAAE,yBAAML,SAAQ,CAAC,IAAI,CAAC,EAAC,UACnCP,KAAK,CAAG,KAAK,CAAGD,IAAI,CAACY,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAC5B,cAET,eAAQ,OAAO,CAAE,yBAAMJ,SAAQ,CAAC,IAAI,CAAC,EAAC,UAAEP,KAAK,EAC9C,cACD,KAAC,KAAK,EAAC,OAAO,CAAEM,KAAM,CAAC,UAAU,CAAEC,QAAS,uBAC1C,aAAK,SAAS,CAAElB,OAAO,CAACwB,YAAa,wBACnC,aAAK,SAAS,CAAExB,OAAO,CAACyB,SAAU,wBAChC,WAAI,uBAAuB,CAAE,CAAEJ,MAAM,CAAEX,IAAK,CAAE,EAAM,cACpD,YAAK,GAAG,CAAC,EAAE,CAAC,GAAG,CAAEE,OAAQ,EAAO,GAC5B,cACN,aAAK,SAAS,CAAEZ,OAAO,CAAC0B,GAAI,wBAC1B,cACE,KAAK,CAAEX,MAAO,CACd,QAAQ,CAAE,kBAACY,CAAC,CAAK,CACf,GAAIA,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CAClBb,SAAS,CAACc,IAAI,CAACC,IAAI,CAACJ,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CACtC,CAAC,IAAM,CACLb,SAAS,CAAC,EAAE,CAAC,CACf,CACF,CAAE,CACF,IAAI,CAAC,QAAQ,CACb,GAAG,CAAC,GAAG,CACP,WAAW,CAAC,iEAAe,EACpB,cACT,eACE,QAAQ,CAAEH,IAAI,CAACmB,OAAO,CAAGrB,KAAK,CAAGI,MAAM,CAAG,CAAC,EAAIA,MAAM,EAAI,CAAE,CAC3D,OAAO,CAAE,kBAAM,CACbG,QAAQ,CAAC,KAAK,CAAC,CACfC,OAAO,EAAE,CACTN,IAAI,CAACmB,OAAO,EAAIrB,KAAK,CAAGI,MAAM,CAChC,CAAE,kDAGK,cACT,iEAAeF,IAAI,CAACmB,OAAO,GAAQ,CAClCnB,IAAI,CAACmB,OAAO,CAAGrB,KAAK,CAAGI,MAAM,CAAG,CAAC,SAAS,cACzC,yFAA0B,cAE1B,mFACcZ,SAAS,CAAC8B,MAAM,CAACpB,IAAI,CAACmB,OAAO,CAAGrB,KAAK,CAAGI,MAAM,CAAC,GAE9D,GACG,GACF,EACA,GACJ,CAEV"},"metadata":{},"sourceType":"module"}